<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Word-based analysis with song lyrics</title>
    <link rel="stylesheet" href="/assets/built/screen.css?v=eeea2d2947">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,400;0,700;0,800;1,400;1,700&display=swap">

    <script>
        var siteUrl = 'https://blog.karnwong.me';
    </script>

    <script>
        var localTheme = localStorage.getItem('dawn_theme');
        switch (localTheme) {
            case 'dark':
                document.documentElement.classList.add('theme-dark');
                break;
            case 'light':
                document.documentElement.classList.add('theme-light');
                break;
            default:
                break;
        }
    </script>

    <link rel="canonical" href="https://blog.karnwong.me/word-based-analysis-with-song-lyrics/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://blog.karnwong.me/word-based-analysis-with-song-lyrics/amp/" />
    
    <meta property="og:site_name" content="Karn Wong&#x27;s Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Word-based analysis with song lyrics" />
    <meta property="og:description" content="I listen to a lot of music, mostly symphonic heavy metal. What&#x27;s interesting is that in this genre, each album often has different themes, also each band focus on different topics in terms of lyrics. For instance, Nightwish focuses on nature, and their Imaginaerum album focuses on evolution. So I" />
    <meta property="og:url" content="https://blog.karnwong.me/word-based-analysis-with-song-lyrics/" />
    <meta property="og:image" content="https://static.ghost.org/v3.0.0/images/publication-cover.png" />
    <meta property="article:published_time" content="2020-04-15T17:00:00.000Z" />
    <meta property="article:modified_time" content="2020-08-22T08:45:07.000Z" />
    <meta property="article:tag" content="data analysis" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Word-based analysis with song lyrics" />
    <meta name="twitter:description" content="I listen to a lot of music, mostly symphonic heavy metal. What&#x27;s interesting is that in this genre, each album often has different themes, also each band focus on different topics in terms of lyrics. For instance, Nightwish focuses on nature, and their Imaginaerum album focuses on evolution. So I" />
    <meta name="twitter:url" content="https://blog.karnwong.me/word-based-analysis-with-song-lyrics/" />
    <meta name="twitter:image" content="https://static.ghost.org/v3.0.0/images/publication-cover.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Karn Wong" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="data analysis" />
    <meta property="og:image:width" content="2709" />
    <meta property="og:image:height" content="938" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Karn Wong&#x27;s Blog",
        "url": "https://blog.karnwong.me/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.karnwong.me/favicon.ico"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Karn Wong",
        "url": "https://blog.karnwong.me/author/karn/",
        "sameAs": []
    },
    "headline": "Word-based analysis with song lyrics",
    "url": "https://blog.karnwong.me/word-based-analysis-with-song-lyrics/",
    "datePublished": "2020-04-15T17:00:00.000Z",
    "dateModified": "2020-08-22T08:45:07.000Z",
    "keywords": "data analysis",
    "description": "I listen to a lot of music, mostly symphonic heavy metal. What&#x27;s interesting is\nthat in this genre, each album often has different themes, also each band focus\non different topics in terms of lyrics. For instance, Nightwish focuses on\nnature, and their Imaginaerum album focuses on evolution. So I thought it would\nbe interesting if I apply various text analysis methods to the lyrics, which\nresulted in this article. Github link here\n[https://github.com/kahnwong/lyrics_visualization]!\n\nTechniques u",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.karnwong.me/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.11" />
    <link rel="alternate" type="application/rss+xml" title="Karn Wong&#x27;s Blog" href="https://blog.karnwong.me/rss/" />
    <script defer src="https://unpkg.com/@tryghost/portal@~1.8.0/umd/portal.min.js" data-ghost="https://blog.karnwong.me/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script>
    var gh_search_key = 'b8731363f41451221229dd694c';
    var gh_search_migration = '2021-02-14';
</script>

<style>
    .single-content > pre {
        grid-column: wide-start/wide-end;
	}
    header.site-header .header-right button, section.single-cta, .cover-cta {
    	display: none;
     
  }
    }
<style><style>:root {--ghost-accent-color: #066dd6;}</style>
</head>

<body class="post-template tag-data-analysis">
    <svg width="0" height="0" style="display: none;">
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="arrow-left">
        <path d="M26.667 14.667v2.667h-16L18 24.667l-1.893 1.893L5.547 16l10.56-10.56L18 7.333l-7.333 7.333h16z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="arrow-right">
        <path d="M5.333 14.667v2.667h16L14 24.667l1.893 1.893L26.453 16 15.893 5.44 14 7.333l7.333 7.333h-16z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="brightness-2">
        <path
            d="M13.333 2.667c-2.427 0-4.707.667-6.667 1.8 4 2.307 6.667 6.6 6.667 11.533s-2.667 9.227-6.667 11.533c1.96 1.133 4.24 1.8 6.667 1.8 7.36 0 13.333-5.973 13.333-13.333S20.693 2.667 13.333 2.667z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="chevron-left">
        <path d="M20.547 22.107L14.44 16l6.107-6.12L18.667 8l-8 8 8 8 1.88-1.893z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="chevron-right">
        <path d="M11.453 22.107L17.56 16l-6.107-6.12L13.333 8l8 8-8 8-1.88-1.893z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="circle-half-full">
        <path
            d="M16 2.667c-7.36 0-13.333 5.973-13.333 13.333s5.973 13.333 13.333 13.333c7.36 0 13.333-5.973 13.333-13.333s-5.973-13.333-13.333-13.333zM16 5.333c5.893 0 10.667 4.773 10.667 10.667s-4.773 10.667-10.667 10.667v-21.333z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="dots-horizontal">
        <path
            d="M21.333 16c0-1.473 1.194-2.667 2.667-2.667v0c1.473 0 2.667 1.194 2.667 2.667v0c0 1.473-1.194 2.667-2.667 2.667v0c-1.473 0-2.667-1.194-2.667-2.667v0zM13.333 16c0-1.473 1.194-2.667 2.667-2.667v0c1.473 0 2.667 1.194 2.667 2.667v0c0 1.473-1.194 2.667-2.667 2.667v0c-1.473 0-2.667-1.194-2.667-2.667v0zM5.333 16c0-1.473 1.194-2.667 2.667-2.667v0c1.473 0 2.667 1.194 2.667 2.667v0c0 1.473-1.194 2.667-2.667 2.667v0c-1.473 0-2.667-1.194-2.667-2.667v0z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="facebook-box">
        <path
            d="M6.667 4h18.667c1.467 0 2.667 1.2 2.667 2.667v18.667c0 1.467-1.2 2.667-2.667 2.667H6.667A2.675 2.675 0 0 1 4 25.334V6.667C4 5.2 5.2 4 6.667 4zM24 6.667h-3.333A4.672 4.672 0 0 0 16 11.334v3.333h-2.667v4H16V28h4v-9.333h4v-4h-4V12c0-.733.6-1.333 1.333-1.333H24v-4z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="facebook">
        <path
            d="M22.667 2.667V8H20c-.92 0-1.333 1.08-1.333 2v3.333h4v5.333h-4v10.667h-5.333V18.666h-4v-5.333h4V8a5.332 5.332 0 0 1 5.333-5.333h4z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="linkedin">
        <path
            d="M25.333 4c1.473 0 2.667 1.194 2.667 2.667v0 18.667c0 1.473-1.194 2.667-2.667 2.667v0h-18.667c-1.473 0-2.667-1.194-2.667-2.667v0-18.667c0-1.473 1.194-2.667 2.667-2.667v0h18.667zM24.667 24.667v-7.067c0-2.401-1.946-4.347-4.347-4.347v0c-1.133 0-2.453 0.693-3.093 1.733v-1.48h-3.72v11.16h3.72v-6.573c0-1.027 0.827-1.867 1.853-1.867 1.031 0 1.867 0.836 1.867 1.867v0 6.573h3.72zM9.173 11.413c1.237 0 2.24-1.003 2.24-2.24v0c0-1.24-1-2.253-2.24-2.253-1.244 0-2.253 1.009-2.253 2.253v0c0 1.24 1.013 2.24 2.253 2.24zM11.027 24.667v-11.16h-3.693v11.16h3.693z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" id="loader">
        <path opacity="0.3" fill="currentColor"
            d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946 s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634 c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z" />
        <path fill="currentColor"
            d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0 C22.32,8.481,24.301,9.057,26.013,10.047z">
            <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 20 20" to="360 20 20"
                dur="0.5s" repeatCount="indefinite" />
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="magnify">
        <path
            d="M12.667 4a8.667 8.667 0 0 1 8.667 8.667c0 2.147-.787 4.12-2.08 5.64l.36.36h1.053l6.667 6.667-2 2-6.667-6.667v-1.053l-.36-.36a8.689 8.689 0 0 1-5.64 2.08C7.88 21.334 4 17.454 4 12.667S7.88 4 12.667 4zm0 2.667c-3.333 0-6 2.667-6 6s2.667 6 6 6 6-2.667 6-6-2.667-6-6-6z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="menu-down">
        <path d="M9.333 13.333L16 20l6.667-6.667H9.334z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="rss-box">
        <path
            d="M6.667 4h18.667c1.467 0 2.667 1.2 2.667 2.667v18.667c0 1.467-1.2 2.667-2.667 2.667H6.667A2.675 2.675 0 0 1 4 25.334V6.667C4 5.2 5.2 4 6.667 4zM10 20c-1.107 0-2 .893-2 2s.893 2 2 2 2-.893 2-2-.893-2-2-2zm-2-6.667V16c4.413 0 8 3.587 8 8h2.667c0-5.893-4.773-10.667-10.667-10.667zM8 8v2.667c7.36 0 13.333 5.973 13.333 13.333H24c0-8.84-7.16-16-16-16z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="star">
        <path
            d="M16 23.027L24.24 28l-2.187-9.373 7.28-6.307-9.587-.827-3.747-8.827-3.747 8.827-9.587.827 7.267 6.307L7.759 28l8.24-4.973z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="table-of-contents">
        <path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="twitter-box">
        <path
            d="M6.667 4h18.667c1.467 0 2.667 1.2 2.667 2.667v18.667c0 1.467-1.2 2.667-2.667 2.667H6.667A2.675 2.675 0 0 1 4 25.334V6.667C4 5.2 5.2 4 6.667 4zm16.946 8.44c.64-.533 1.387-1.173 1.72-1.88-.547.28-1.2.453-1.92.547.667-.48 1.213-1.107 1.493-1.96-.693.373-1.4.693-2.28.853-2.067-2.493-7.013-.467-6.133 3.267-3.48-.213-5.6-1.787-7.36-3.72-1 1.627-.133 4.093 1.053 4.773-.613-.04-1.08-.227-1.52-.44.053 2.053 1.187 3.04 2.773 3.573a4.47 4.47 0 0 1-1.52.04c.493 1.427 1.52 2.32 3.28 2.507-1.2 1.013-3.413 1.72-5.2 1.44 1.533.973 3.28 1.747 5.707 1.64 5.88-.267 9.813-4.48 9.907-10.64z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="twitter">
        <path
            d="M29.947 8a11.423 11.423 0 0 1-3.28.92 5.738 5.738 0 0 0 2.507-3.173 11.52 11.52 0 0 1-3.627 1.4C24.494 6 23.014 5.334 21.334 5.334c-3.133 0-5.693 2.56-5.693 5.72 0 .453.053.893.147 1.307A16.261 16.261 0 0 1 4.001 6.388a5.663 5.663 0 0 0-.773 2.867c0 1.987 1 3.747 2.547 4.747-.947 0-1.827-.267-2.6-.667v.04a5.724 5.724 0 0 0 4.587 5.613 5.644 5.644 0 0 1-2.574.093c.72 2.253 2.813 3.933 5.333 3.973-1.947 1.547-4.413 2.453-7.107 2.453-.453 0-.907-.027-1.36-.08A16.19 16.19 0 0 0 10.827 28c10.507 0 16.28-8.72 16.28-16.28 0-.253 0-.493-.013-.747A11.42 11.42 0 0 0 29.947 8z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="white-balance-sunny">
        <path
            d="M4.733 24.72l1.88 1.88 2.4-2.387L7.12 22.32zm9.934 5.213h2.667V26h-2.667zM16 7.333c-4.413 0-8 3.587-8 8s3.587 8 8 8 8-3.587 8-8c0-4.427-3.587-8-8-8zm10.667 9.334h4V14h-4zm-3.68 7.546l2.4 2.387 1.88-1.88-2.387-2.4zm4.28-18.266l-1.88-1.88-2.4 2.387 1.893 1.893zM17.333.733h-2.667v3.933h2.667zM5.333 14h-4v2.667h4zm3.68-7.547l-2.4-2.387-1.88 1.88 2.387 2.4 1.893-1.893z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="window-close">
        <path
            d="M17.947 16l7.387 7.387v1.947h-1.947L16 17.947l-7.387 7.387H6.666v-1.947L14.053 16 6.666 8.613V6.666h1.947L16 14.053l7.387-7.387h1.947v1.947L17.947 16z">
        </path>
    </symbol>
</svg>
    <div class="site">
        <header class="site-header container">
    <div class="header-left">
        <a class="logo" href="https://blog.karnwong.me">
                <span class="logo-text">Karn Wong&#x27;s Blog</span>
        </a>

        <a class="social-link" href="https://webring.wonderful.software#blog.karnwong.me" title="webring">
            <img alt="webring" width="32" height="32" src="https://webring.wonderful.software/webring.svg" style="padding-left: 10px;"/>
        </a>
        
    </div>
        <nav class="main-nav hidden-xs hidden-sm hidden-md">
                <a class="menu-item menu-item-homepage"
        href="https://www.karnwong.me/">Homepage</a>
    <a class="menu-item menu-item-posts"
        href="https://blog.karnwong.me/">Posts</a>
    <a class="menu-item menu-item-tags"
        href="https://blog.karnwong.me/tag/data-engineering/">Tags</a>
    <a class="menu-item menu-item-resume"
        href="https://www.karnwong.me/resume">Resume</a>

            <button class="button-icon menu-item-button js-modal" data-modal="search" aria-label="Search">
                <svg class="icon">
                    <use xlink:href="#magnify"></use>
                </svg>
            </button>
        </nav>

        <button class="button-icon hidden-lg hidden-xl js-modal" data-modal="search" aria-label="Search">
            <svg class="icon">
                <use xlink:href="#magnify"></use>
            </svg>
        </button>
        <div class="burger hidden-lg hidden-xl">
            <div class="burger-bar"></div>
            <div class="burger-bar"></div>
        </div>

        <div class="mobile-menu hidden-lg hidden-xl">
            <div class="container">
                <nav class="mobile-nav">
                        <a class="menu-item menu-item-homepage"
        href="https://www.karnwong.me/">Homepage</a>
    <a class="menu-item menu-item-posts"
        href="https://blog.karnwong.me/">Posts</a>
    <a class="menu-item menu-item-tags"
        href="https://blog.karnwong.me/tag/data-engineering/">Tags</a>
    <a class="menu-item menu-item-resume"
        href="https://www.karnwong.me/resume">Resume</a>

                        <button class="button-text menu-item members-login" data-portal="signin">Login</button>
                        <button class="button-text menu-item menu-item-cta members-subscribe" data-portal="signup">Subscribe</button>
                </nav>
            </div>
        </div>
    <div class="header-right hidden-xs hidden-sm hidden-md">
            <button class="button-text menu-item members-login" data-portal="signin">Login</button>
            <button class="button-text menu-item menu-item-cta members-subscribe" data-portal="signup">Subscribe</button>
    </div>
</header>

        <header class="sticky">
            <div class="sticky-title">Word-based analysis with song lyrics</div>
            <button class="button-icon sticky-toc-button" aria-label="Table of Contents">
                <svg class="icon">
                    <use xlink:href="#table-of-contents"></use>
                </svg>
                <div class="sticky-toc"></div>
            </button>
            <div class="sticky-track">
                <div class="sticky-progress"></div>
            </div>
        </header>
        <div class="site-content">
            
<div class="content-area">
    <main class="site-main">
            <article class="single post tag-data-analysis no-image">
    <header class="single-header kg-canvas">
            <div class="single-meta">
                <span class="single-meta-item single-meta-date">
                    <time datetime="2020-04-16">
                        Apr 16, 2020
                    </time>
                </span>
                <span class="single-meta-item single-meta-length">
                    7 min read
                </span>
                    <span class="single-meta-item single-meta-tag">
                        <a class="post-tag post-tag-data-analysis" href="/tag/data-analysis/">
                            data analysis
                        </a>
                    </span>
            </div>
        <h1 class="single-title">Word-based analysis with song lyrics</h1>
    </header>
    <div class="single-content kg-canvas u-text-format">
        <!--kg-card-begin: markdown--><p>I listen to a lot of music, mostly symphonic heavy metal. What's interesting is that in this genre, each album often has different themes, also each band focus on different topics in terms of lyrics. For instance, Nightwish focuses on nature, and their Imaginaerum album focuses on evolution. So I thought it would be interesting if I apply various text analysis methods to the lyrics, which resulted in this article. Github link <a href="https://github.com/kahnwong/lyrics_visualization">here</a>!</p>
<h2 id="techniquesused">Techniques used:</h2>
<ul>
<li>tokenization</li>
<li>stemming and lemming</li>
<li>topic modeling</li>
</ul>
<h1 id="importmodules">Import modules</h1>
<pre><code class="language-python">from collections import Counter

import matplotlib.colors as colors
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import seaborn as sns
from nltk import word_tokenize
# from nltk.corpus import stopwords
from nltk.stem import PorterStemmer
from sklearn.decomposition import NMF, LatentDirichletAllocation
from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer

sns.set()
</code></pre>
<h1 id="importdatageneratedfrom01_get_datapy">Import data generated from 01_get_data.py</h1>
<p>In this step, I import raw data and convert raw year into a decade, for instance 1993 is in 1990s. I won't be doing analysis by decades, because in heavy metal it doesn't follow the trend much. But I include it here in case you are working on pop artists. In addition, the differences by year may not be that large, so it makes sense to see it in terms of decades.</p>
<pre><code class="language-python">df = pd.read_csv('lyrics.csv')

# dop song duplicates from the same artist
df.drop_duplicates(subset=['artist', 'title'], inplace=True)

# tokenize, remove stopwords, stemming and lemming
# stop_words = set(stopwords.words('english'))
with open('english.txt', 'r') as f:
    stop_words = [i.strip() for i in f.readlines()]
    
ps = PorterStemmer()
df['tokens'] = df.lyrics.apply(
    lambda x: [ps.stem(w) 
    for w in word_tokenize(x.lower()) 
    if 
         (not w in stop_words) and
         (not &quot;'&quot; in w) and
         (len(w) &gt; 1)
    ])

# count words
df['word_count'] = df.tokens.apply(lambda x: len(x))

# count unique words
df['unique_word_count'] = df.tokens.apply(lambda x: len(set(x)))

# remove outliers
df = df[df.word_count&gt;10]

# set decade
df['year'] = df.year.astype(int)
df['1990s'] = np.where(
                ((1990&lt;=df.year) &amp; (df.year &lt;=1999)),
                '1990s',
                None
            )

df['2000s'] = np.where(
                ((2000&lt;=df.year) &amp; (df.year &lt;=2009)),
                '2000s',
                None
            )

df['2010s'] = np.where(
                ((2010&lt;=df.year) &amp; (df.year &lt;=2019)),
                '2010s',
                None
            )

df['2020s'] = np.where(
                ((2020&lt;=df.year) &amp; (df.year &lt;=2029)),
                '2020s',
                None
            )

df['decade'] = df['1990s'].combine_first(df['2000s']).combine_first(df['2010s']).combine_first(df['2020s'])

# drop unused columns
df = df.drop(columns=['1990s', '2000s', '2010s', '2020s'])

df
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:left">artist</th>
<th style="text-align:left">album</th>
<th style="text-align:left">title</th>
<th style="text-align:left">lyrics</th>
<th style="text-align:right">year</th>
<th style="text-align:left">tokens</th>
<th style="text-align:right">word_count</th>
<th style="text-align:right">unique_word_count</th>
<th style="text-align:left">decade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:left">Nightwish</td>
<td style="text-align:left">Angels Fall First</td>
<td style="text-align:left">Elvenpath</td>
<td style="text-align:left">(In the sh</td>
<td style="text-align:right">1996</td>
<td style="text-align:left">['shelter', 'shade', 'forest', ...]</td>
<td style="text-align:right">121</td>
<td style="text-align:right">90</td>
<td style="text-align:left">1990s</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:left">Nightwish</td>
<td style="text-align:left">Angels Fall First</td>
<td style="text-align:left">Beauty And The Beast</td>
<td style="text-align:left">Remember t</td>
<td style="text-align:right">1996</td>
<td style="text-align:left">['rememb', 'danc', 'share', ...]</td>
<td style="text-align:right">74</td>
<td style="text-align:right">56</td>
<td style="text-align:left">1990s</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:left">Nightwish</td>
<td style="text-align:left">Angels Fall First</td>
<td style="text-align:left">The Carpenter</td>
<td style="text-align:left">Who are yo</td>
<td style="text-align:right">1996</td>
<td style="text-align:left">['condemn', 'shine', 'salvat', ...]</td>
<td style="text-align:right">74</td>
<td style="text-align:right">42</td>
<td style="text-align:left">1990s</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:left">Nightwish</td>
<td style="text-align:left">Angels Fall First</td>
<td style="text-align:left">Astral Romance</td>
<td style="text-align:left">A nocturna</td>
<td style="text-align:right">1996</td>
<td style="text-align:left">['nocturn', 'concerto', 'candlelight', ...]</td>
<td style="text-align:right">69</td>
<td style="text-align:right">68</td>
<td style="text-align:left">1990s</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:left">Nightwish</td>
<td style="text-align:left">Angels Fall First</td>
<td style="text-align:left">Angels Fall First</td>
<td style="text-align:left">An angelfa</td>
<td style="text-align:right">1996</td>
<td style="text-align:left">['angelfac', 'smile', 'headlin', ...]</td>
<td style="text-align:right">68</td>
<td style="text-align:right">49</td>
<td style="text-align:left">1990s</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:left">Nightwish</td>
<td style="text-align:left">Angels Fall First</td>
<td style="text-align:left">Tutankhamen</td>
<td style="text-align:left">As the sun</td>
<td style="text-align:right">1996</td>
<td style="text-align:left">['sun', 'set', 'pyramid', ...]</td>
<td style="text-align:right">67</td>
<td style="text-align:right">41</td>
<td style="text-align:left">1990s</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:left">Nightwish</td>
<td style="text-align:left">Angels Fall First</td>
<td style="text-align:left">Nymphomaniac Fantasia</td>
<td style="text-align:left">The scent</td>
<td style="text-align:right">1996</td>
<td style="text-align:left">['scent', 'woman', '...']</td>
<td style="text-align:right">29</td>
<td style="text-align:right">28</td>
<td style="text-align:left">1990s</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:left">Nightwish</td>
<td style="text-align:left">Angels Fall First</td>
<td style="text-align:left">Know Why The Nightingale Sings</td>
<td style="text-align:left">What does</td>
<td style="text-align:right">1996</td>
<td style="text-align:left">['fall', 'feel', 'boy', ...]</td>
<td style="text-align:right">49</td>
<td style="text-align:right">47</td>
<td style="text-align:left">1990s</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:left">Nightwish</td>
<td style="text-align:left">Angels Fall First</td>
<td style="text-align:left">Lappi (Lapland)</td>
<td style="text-align:left">Part 1: Er</td>
<td style="text-align:right">1996</td>
<td style="text-align:left">['erämaajärvi', 'kautta', 'erämaajärven', ...]</td>
<td style="text-align:right">63</td>
<td style="text-align:right">54</td>
<td style="text-align:left">1990s</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:left">Nightwish</td>
<td style="text-align:left">Angels Fall First</td>
<td style="text-align:left">Once Upon A Troubadour</td>
<td style="text-align:left">A lonely b</td>
<td style="text-align:right">1996</td>
<td style="text-align:left">['lone', 'bard', 'wander', ...]</td>
<td style="text-align:right">91</td>
<td style="text-align:right">62</td>
<td style="text-align:left">1990s</td>
</tr>
</tbody>
</table>
<h1 id="explorerelationship">Explore relationship</h1>
<p>From this plot, I can see that there is a correlation between <code>word_count</code> and <code>unique_word_count</code>, that is, they go in the same direction. The higher the word_count, the higher unique_word_count and vice versa.</p>
<pre><code class="language-python">g = sns.PairGrid(df[['word_count', 'unique_word_count']])
g.map(plt.scatter)
</code></pre>
<!--kg-card-end: markdown--><figure class="kg-card kg-image-card"><img src="https://blog.karnwong.me/content/images/2020/08/02_visualize_7_1.png" class="kg-image" alt loading="lazy" width="369" height="370"></figure><!--kg-card-begin: markdown--><h1 id="boxplot">Boxplot</h1>
<p>We can use either <code>word_count</code> or <code>unique_word_count</code>, since they go in the same direction, except the values from <code>unique_word_count</code> will be higher, but it is proportional to <code>word_count</code></p>
<p>Boxplot represents data distribution in quartiles, in which the the box-y area is in middle of the distribution (think of a bell curve, the box-y area is right around the peak, padded a bit to left and right),  and the line-y area is the left/right edge of the curve. The scattered points are outliers, meaning they are too different from the rest of the dataset.</p>
<p>From this figure, I can see that Nightwish has a very large outlier, seeing one data point is in 350 range. Myrath has the least words, and Linkin Park has the most. For Linkin Park, it can be attributed to the fact that their lyrics contain rap verses. As for Nightwish outliers, some of their songs contain very lengthy spoken parts.</p>
<pre><code class="language-python">plt.figure(figsize=(10,7))
sns.boxplot(x=&quot;word_count&quot;, y=&quot;artist&quot;, data=df, orient='h')
</code></pre>
<!--kg-card-end: markdown--><figure class="kg-card kg-image-card"><img src="https://blog.karnwong.me/content/images/2020/08/02_visualize_9_1.png" class="kg-image" alt loading="lazy" width="690" height="428" srcset="https://blog.karnwong.me/content/images/size/w600/2020/08/02_visualize_9_1.png 600w, https://blog.karnwong.me/content/images/2020/08/02_visualize_9_1.png 690w"></figure><!--kg-card-begin: markdown--><h1 id="mostcommonwords">Most common words</h1>
<p>In this step, I count how many times a word occur per dataset, then plot a bar graph for each. For the bands I usually listen to, each album has a theme, so it's very probable that each album would have different set of most common words.</p>
<pre><code class="language-python">def word_vector(df):
    ########## make a list of all unique words
    all_words = []
    for i in df.tokens:
        all_words.extend(set(i))

    all_words = set(all_words)
    ########## make tf/idf
    word_count = df.tokens.apply(lambda x: Counter(x))
    word_count = pd.DataFrame(word_count.to_list())
    ########## get sum for each unique word
    wordcount_sum = []
    for i in word_count.columns:
        wordcount_sum.append({
            'word': i,
            'count': word_count[i].sum()
        })

    wordcount_sum = pd.DataFrame(wordcount_sum)
    wordcount_sum = wordcount_sum[wordcount_sum['count']!=0]
    wordcount_sum.sort_values(by='count', ascending=False, inplace=True)
    ##########

    return wordcount_sum.head(10)

# get wordcount for each group, this way the word_vector function is not getting messy
wordcount_group = []
################# adjust filters here
artist = 'Epica'
group = 'album' # album, decade
#################
df_temp = df[df.artist==artist]
for i in df_temp[group].unique():
    chunk = word_vector(df_temp[df[group]==i])
    chunk[group] = i
    wordcount_group.append(chunk)

wordcount_group = pd.concat(wordcount_group)

# plot
fig, axs = plt.subplots(len(wordcount_group[group].unique()), figsize=(13,53)) # adjust figure size here if it's too cramped
for index, i in enumerate(wordcount_group[group].unique()):
    temp = wordcount_group[wordcount_group[group]==i]
    axs[index].bar(temp['word'], temp['count'])
    axs[index].set_title(i)
</code></pre>
<!--kg-card-end: markdown--><figure class="kg-card kg-image-card"><img src="https://blog.karnwong.me/content/images/2020/08/02_visualize_11_1.png" class="kg-image" alt loading="lazy" width="770" height="2929" srcset="https://blog.karnwong.me/content/images/size/w600/2020/08/02_visualize_11_1.png 600w, https://blog.karnwong.me/content/images/2020/08/02_visualize_11_1.png 770w" sizes="(min-width: 720px) 720px"></figure><!--kg-card-begin: markdown--><p>From the above image, you can see that the top words don't vary much between albums. So I can conclude that Epica have a consistent lyric themes, but if you listen you can hear that their melody changes every album. For instance, in The Divine Conspiracy, it's very classical and oriental oriented, but in The Holographic Principle it gets heavier.</p>
<p>But that's only variations between albums from one artist. What if we do the same but with each artist instead?</p>
<pre><code class="language-python">wordcount_group = []
df_temp = df
group = 'artist'
for i in df_temp[group].unique():
    chunk = word_vector(df_temp[df[group]==i])
    chunk[group] = i
    wordcount_group.append(chunk)

wordcount_group = pd.concat(wordcount_group)

fig, axs = plt.subplots(len(wordcount_group[group].unique()), figsize=(13,80)) # adjust figure size here if it's too cramped
for index, i in enumerate(wordcount_group[group].unique()):
    temp = wordcount_group[wordcount_group[group]==i]
    axs[index].bar(temp['word'], temp['count'])
    axs[index].set_title(i)
</code></pre>
<!--kg-card-end: markdown--><figure class="kg-card kg-image-card"><img src="https://blog.karnwong.me/content/images/2020/08/02_visualize_14_0.png" class="kg-image" alt loading="lazy" width="767" height="4396" srcset="https://blog.karnwong.me/content/images/size/w600/2020/08/02_visualize_14_0.png 600w, https://blog.karnwong.me/content/images/2020/08/02_visualize_14_0.png 767w" sizes="(min-width: 720px) 720px"></figure><!--kg-card-begin: markdown--><p>Whoops. Still more or less the same. But if you look carefully, Powerwolf stands out because their lyrical themes are werewolves and myths.</p>
<h1 id="topicmodeling">Topic modeling</h1>
<p>So I change the tactics a bit by using topic modeling instead of seeing just the top words count. This way, the model and extract group of words that said to be the essence belonging to each cluster. I use both NMF and LDA here for comparison. Here, I tell the model to read lyrics from four artists, then try to group into clusters and finding main words from each, but I'm not telling it which document belongs to which artist.</p>
<pre><code class="language-python">def display_topics(model, feature_names, no_top_words):
    topic_words = []
    for topic_idx, topic in enumerate(model.components_):
        print (&quot;Topic %d:&quot; % (topic_idx))
        topic = (&quot; &quot;.join([feature_names[i] for i in topic.argsort()[:-no_top_words - 1:-1]]))
        print('\t' + topic)
        topic_words.append(topic)
        
    return topic_words

# define temp dataframe here
temp = df.query('artist == &quot;Visions of Atlantis&quot; or\
                artist == &quot;Lacuna Coil&quot; or\
                artist == &quot;Epica&quot; or\
                artist == &quot;Nightwish&quot;')

# define parameters
no_features = 1000
no_topics = len(temp.artist.unique()) # set album count as number of topics
no_top_words = 15

# create word matrix
tfidf_vectorizer = TfidfVectorizer(max_df=0.95, min_df=2, max_features=no_features, stop_words='english')
tfidf = tfidf_vectorizer.fit_transform(temp.lyrics)
tfidf_feature_names = tfidf_vectorizer.get_feature_names()

print('========== NMF ==========')
nmf = NMF(n_components=no_topics, random_state=1, alpha=.1, l1_ratio=.5, init='nndsvd').fit(tfidf)
topic_words = display_topics(nmf, tfidf_feature_names, no_top_words)
</code></pre>
<pre><code>========== NMF ==========
Topic 0:
	ll time life way light come live free just feel inside ve day let world
Topic 1:
	love heart night wish forever hate soul dream oh art rest heaven need kiss lust
Topic 2:
	away run far stay inside journey dream fade just wash felt destruction escape falling walked
Topic 3:
	don know wanna want just feel say care hate goes cause liar let look reason
</code></pre>
<pre><code class="language-python">print('========== LDA ==========')

lda = LatentDirichletAllocation(n_components=no_topics, max_iter=5, learning_method='online', learning_offset=50.,random_state=0).fit(tfidf)
topic_words = display_topics(lda, tfidf_feature_names, no_top_words)
</code></pre>
<pre><code>========== LDA ==========
Topic 0:
	distance don beautiful let today cold look guide read world way faith wish mind heart
Topic 1:
	est tale feels talking drives wall wishmaster disciple bone mad searching free master apprentice sing
Topic 2:
	love heart ll hearts time world fight let come night know shadows try eyes mind
Topic 3:
	leaving ll healing endless sed died walk desire life nos ne moment die nostra like
</code></pre>
<p>From NMF, I can tell that:</p>
<ul>
<li>Topic 0 is Epica</li>
<li>Topic 1 is Nightwish</li>
<li>Topic 2 is Visions of Atlantis</li>
<li>Topic 3 is Lacuna Coil</li>
</ul>
<p>I think NMF performs better in this case 😆</p>
<p>There are some instances LDA performs better, but generally unless it's very obvious from the start, sometimes you use different models and see which performs best for a given dataset.</p>
<!--kg-card-end: markdown-->
    </div>
        <footer class="single-footer container medium">
            <div class="single-footer-left">
                    <div class="navigation navigation-previous">
                        <a class="navigation-link" href="/yuuemuue-ngaithykinkluuetnaimaidchaanglambaak/"
                            aria-label="Previous post">
                            <svg class="icon navigation-icon">
                                <use xlink:href="#arrow-left"></use>
                            </svg>
                        </a>
                    </div>
            </div>
            <div class="single-footer-right">
                    <div class="navigation navigation-next">
                        <a class="navigation-link" href="/impute-pipelines/"
                            aria-label="Next post">
                            <svg class="icon navigation-icon">
                                <use xlink:href="#arrow-right"></use>
                            </svg>
                        </a>
                    </div>
            </div>
        </footer>
</article>                    <section class="related-wrapper">
            <div class="container medium">
                <h3 class="related-title">You might also like...</h3>
                <div class="related-feed">
                        <article class="feed post no-image">
    <div class="feed-calendar">
        <div class="feed-calendar-month">
            Sep
        </div>
        <div class="feed-calendar-day">
            03
        </div>
    </div>
    <h2 class="feed-title">Visualizing map region prefix/suffix</h2>
    <div class="feed-right">
        <svg class="icon feed-visibility feed-visibility-public">
            <use xlink:href="#star"></use>
        </svg>
        <div class="feed-length">
            5 min read
        </div>
    </div>
    <svg class="icon feed-icon">
        <use xlink:href="#chevron-right"></use>
    </svg>
    <a class="u-permalink" href="/visualizing-map-region-prefix-suffix/" aria-label="Visualizing map region prefix/suffix"></a>
</article>                        <article class="feed post no-image">
    <div class="feed-calendar">
        <div class="feed-calendar-month">
            Jul
        </div>
        <div class="feed-calendar-day">
            31
        </div>
    </div>
    <h2 class="feed-title">Resettled refugees in Sweden</h2>
    <div class="feed-right">
        <svg class="icon feed-visibility feed-visibility-public">
            <use xlink:href="#star"></use>
        </svg>
        <div class="feed-length">
            4 min read
        </div>
    </div>
    <svg class="icon feed-icon">
        <use xlink:href="#chevron-right"></use>
    </svg>
    <a class="u-permalink" href="/resettled-refugees-in-sweden/" aria-label="Resettled refugees in Sweden"></a>
</article>                </div>
            </div>
        </section>
                </main>
</div>
        </div>
        <footer class="site-footer container">
    <div class="social">
        <a class="social-item social-item-rss"
            href="https://blog.karnwong.me/rss/"
            target="_blank" rel="noopener noreferrer" aria-label="RSS">
            <svg class="icon">
                <use xlink:href="#rss-box"></use>
            </svg>
        </a>
    </div>

    <div class="copyright">
        Powered by <a href="https://ghost.org/" target="_blank"
            rel="noopener noreferrer">Ghost</a>
    </div>

    <nav class="footer-nav">
        
        <a class="menu-item js-theme" href="#" data-system="System theme" data-dark="Dark theme" data-light="Light theme">
            <svg class="icon theme-icon theme-icon-system">
                <use xlink:href="#circle-half-full"></use>
            </svg>
            <svg class="icon theme-icon theme-icon-dark">
                <use xlink:href="#brightness-2"></use>
            </svg>
            <svg class="icon theme-icon theme-icon-light">
                <use xlink:href="#white-balance-sunny"></use>
            </svg>
            <span class="theme-text">System theme</span>
        </a>
    </nav>
</footer>        <div class="modal-overlay">
    <div class="modal modal-search">
        <div class="form-wrapper">
            <input class="modal-input search-input" type="search" placeholder="Enter keyword...">
            <button class="form-button search-button" aria-label="Search">
                <svg class="icon icon-search">
                    <use xlink:href="#magnify"></use>
                </svg>
                <svg class="icon icon-close">
                    <use xlink:href="#window-close"></use>
                </svg>
            </button>
        </div>
                <div class="popular-wrapper">
                    <h4 class="popular-title">Popular tags</h4>
                    <div class="popular-feed">
                            <a class="popular" href="/tag/languages/">languages</a>
                            <a class="popular" href="/tag/celiac/">celiac</a>
                            <a class="popular" href="/tag/data-engineering/">data engineering</a>
                            <a class="popular" href="/tag/infra/">infra</a>
                            <a class="popular" href="/tag/data-analysis/">data analysis</a>
                    </div>
                </div>
        <div class="search-result"></div>
    </div>
    <button class="button-icon modal-close" aria-label="Close">
        <svg class="icon icon-close">
            <use xlink:href="#window-close"></use>
        </svg>
    </button>
</div>        <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe.
        It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides.
          PhotoSwipe keeps only 3 of them in the DOM to save memory.
          Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>    </div>

    <script
        src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous">
    </script>
    <script src="/assets/built/main.min.js?v=eeea2d2947"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/plugins/line-numbers/prism-line-numbers.min.css" />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-okaidia.css" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-markdown.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-toml.min.js"></script>
</body>

</html>