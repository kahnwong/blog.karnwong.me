<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Impute pipelines</title>
    <link rel="stylesheet" href="/assets/built/screen.css?v=eeea2d2947">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,400;0,700;0,800;1,400;1,700&display=swap">

    <script>
        var siteUrl = 'https://blog.karnwong.me';
    </script>

    <script>
        var localTheme = localStorage.getItem('dawn_theme');
        switch (localTheme) {
            case 'dark':
                document.documentElement.classList.add('theme-dark');
                break;
            case 'light':
                document.documentElement.classList.add('theme-light');
                break;
            default:
                break;
        }
    </script>

    <link rel="canonical" href="https://blog.karnwong.me/impute-pipelines/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://blog.karnwong.me/impute-pipelines/amp/" />
    
    <meta property="og:site_name" content="Karn Wong&#x27;s Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Impute pipelines" />
    <meta property="og:description" content="Imagine having a dataset that you need to use for training a prediction model, but some of the features are missing. The good news is you don&#x27;t need to throw some data away, just have to impute them. Below are steps you can take in order to create an imputation" />
    <meta property="og:url" content="https://blog.karnwong.me/impute-pipelines/" />
    <meta property="og:image" content="https://static.ghost.org/v3.0.0/images/publication-cover.png" />
    <meta property="article:published_time" content="2020-05-22T17:00:00.000Z" />
    <meta property="article:modified_time" content="2020-08-22T07:53:05.000Z" />
    <meta property="article:tag" content="data science" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Impute pipelines" />
    <meta name="twitter:description" content="Imagine having a dataset that you need to use for training a prediction model, but some of the features are missing. The good news is you don&#x27;t need to throw some data away, just have to impute them. Below are steps you can take in order to create an imputation" />
    <meta name="twitter:url" content="https://blog.karnwong.me/impute-pipelines/" />
    <meta name="twitter:image" content="https://static.ghost.org/v3.0.0/images/publication-cover.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Karn Wong" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="data science" />
    <meta property="og:image:width" content="2709" />
    <meta property="og:image:height" content="938" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Karn Wong&#x27;s Blog",
        "url": "https://blog.karnwong.me/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.karnwong.me/favicon.ico"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Karn Wong",
        "url": "https://blog.karnwong.me/author/karn/",
        "sameAs": []
    },
    "headline": "Impute pipelines",
    "url": "https://blog.karnwong.me/impute-pipelines/",
    "datePublished": "2020-05-22T17:00:00.000Z",
    "dateModified": "2020-08-22T07:53:05.000Z",
    "keywords": "data science",
    "description": "Imagine having a dataset that you need to use for training a prediction model,\nbut some of the features are missing. The good news is you don&#x27;t need to throw\nsome data away, just have to impute them. Below are steps you can take in order\nto create an imputation pipeline. Github link here!\n[https://github.com/kahnwong/impute-pipelines]\n\nfrom random import randint\n\nimport pandas as pd\nimport numpy as np\n\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.impute import SimpleImputer\nfrom ",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.karnwong.me/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.11" />
    <link rel="alternate" type="application/rss+xml" title="Karn Wong&#x27;s Blog" href="https://blog.karnwong.me/rss/" />
    <script defer src="https://unpkg.com/@tryghost/portal@~1.8.0/umd/portal.min.js" data-ghost="https://blog.karnwong.me/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script>
    var gh_search_key = 'b8731363f41451221229dd694c';
    var gh_search_migration = '2021-02-14';
</script>

<style>
    .single-content > pre {
        grid-column: wide-start/wide-end;
	}
    header.site-header .header-right button, section.single-cta, .cover-cta {
    	display: none;
     
  }
    }
<style><style>:root {--ghost-accent-color: #066dd6;}</style>
</head>

<body class="post-template tag-data-science">
    <svg width="0" height="0" style="display: none;">
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="arrow-left">
        <path d="M26.667 14.667v2.667h-16L18 24.667l-1.893 1.893L5.547 16l10.56-10.56L18 7.333l-7.333 7.333h16z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="arrow-right">
        <path d="M5.333 14.667v2.667h16L14 24.667l1.893 1.893L26.453 16 15.893 5.44 14 7.333l7.333 7.333h-16z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="brightness-2">
        <path
            d="M13.333 2.667c-2.427 0-4.707.667-6.667 1.8 4 2.307 6.667 6.6 6.667 11.533s-2.667 9.227-6.667 11.533c1.96 1.133 4.24 1.8 6.667 1.8 7.36 0 13.333-5.973 13.333-13.333S20.693 2.667 13.333 2.667z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="chevron-left">
        <path d="M20.547 22.107L14.44 16l6.107-6.12L18.667 8l-8 8 8 8 1.88-1.893z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="chevron-right">
        <path d="M11.453 22.107L17.56 16l-6.107-6.12L13.333 8l8 8-8 8-1.88-1.893z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="circle-half-full">
        <path
            d="M16 2.667c-7.36 0-13.333 5.973-13.333 13.333s5.973 13.333 13.333 13.333c7.36 0 13.333-5.973 13.333-13.333s-5.973-13.333-13.333-13.333zM16 5.333c5.893 0 10.667 4.773 10.667 10.667s-4.773 10.667-10.667 10.667v-21.333z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="dots-horizontal">
        <path
            d="M21.333 16c0-1.473 1.194-2.667 2.667-2.667v0c1.473 0 2.667 1.194 2.667 2.667v0c0 1.473-1.194 2.667-2.667 2.667v0c-1.473 0-2.667-1.194-2.667-2.667v0zM13.333 16c0-1.473 1.194-2.667 2.667-2.667v0c1.473 0 2.667 1.194 2.667 2.667v0c0 1.473-1.194 2.667-2.667 2.667v0c-1.473 0-2.667-1.194-2.667-2.667v0zM5.333 16c0-1.473 1.194-2.667 2.667-2.667v0c1.473 0 2.667 1.194 2.667 2.667v0c0 1.473-1.194 2.667-2.667 2.667v0c-1.473 0-2.667-1.194-2.667-2.667v0z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="facebook-box">
        <path
            d="M6.667 4h18.667c1.467 0 2.667 1.2 2.667 2.667v18.667c0 1.467-1.2 2.667-2.667 2.667H6.667A2.675 2.675 0 0 1 4 25.334V6.667C4 5.2 5.2 4 6.667 4zM24 6.667h-3.333A4.672 4.672 0 0 0 16 11.334v3.333h-2.667v4H16V28h4v-9.333h4v-4h-4V12c0-.733.6-1.333 1.333-1.333H24v-4z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="facebook">
        <path
            d="M22.667 2.667V8H20c-.92 0-1.333 1.08-1.333 2v3.333h4v5.333h-4v10.667h-5.333V18.666h-4v-5.333h4V8a5.332 5.332 0 0 1 5.333-5.333h4z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="linkedin">
        <path
            d="M25.333 4c1.473 0 2.667 1.194 2.667 2.667v0 18.667c0 1.473-1.194 2.667-2.667 2.667v0h-18.667c-1.473 0-2.667-1.194-2.667-2.667v0-18.667c0-1.473 1.194-2.667 2.667-2.667v0h18.667zM24.667 24.667v-7.067c0-2.401-1.946-4.347-4.347-4.347v0c-1.133 0-2.453 0.693-3.093 1.733v-1.48h-3.72v11.16h3.72v-6.573c0-1.027 0.827-1.867 1.853-1.867 1.031 0 1.867 0.836 1.867 1.867v0 6.573h3.72zM9.173 11.413c1.237 0 2.24-1.003 2.24-2.24v0c0-1.24-1-2.253-2.24-2.253-1.244 0-2.253 1.009-2.253 2.253v0c0 1.24 1.013 2.24 2.253 2.24zM11.027 24.667v-11.16h-3.693v11.16h3.693z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" id="loader">
        <path opacity="0.3" fill="currentColor"
            d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946 s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634 c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z" />
        <path fill="currentColor"
            d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0 C22.32,8.481,24.301,9.057,26.013,10.047z">
            <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 20 20" to="360 20 20"
                dur="0.5s" repeatCount="indefinite" />
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="magnify">
        <path
            d="M12.667 4a8.667 8.667 0 0 1 8.667 8.667c0 2.147-.787 4.12-2.08 5.64l.36.36h1.053l6.667 6.667-2 2-6.667-6.667v-1.053l-.36-.36a8.689 8.689 0 0 1-5.64 2.08C7.88 21.334 4 17.454 4 12.667S7.88 4 12.667 4zm0 2.667c-3.333 0-6 2.667-6 6s2.667 6 6 6 6-2.667 6-6-2.667-6-6-6z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="menu-down">
        <path d="M9.333 13.333L16 20l6.667-6.667H9.334z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="rss-box">
        <path
            d="M6.667 4h18.667c1.467 0 2.667 1.2 2.667 2.667v18.667c0 1.467-1.2 2.667-2.667 2.667H6.667A2.675 2.675 0 0 1 4 25.334V6.667C4 5.2 5.2 4 6.667 4zM10 20c-1.107 0-2 .893-2 2s.893 2 2 2 2-.893 2-2-.893-2-2-2zm-2-6.667V16c4.413 0 8 3.587 8 8h2.667c0-5.893-4.773-10.667-10.667-10.667zM8 8v2.667c7.36 0 13.333 5.973 13.333 13.333H24c0-8.84-7.16-16-16-16z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="star">
        <path
            d="M16 23.027L24.24 28l-2.187-9.373 7.28-6.307-9.587-.827-3.747-8.827-3.747 8.827-9.587.827 7.267 6.307L7.759 28l8.24-4.973z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="table-of-contents">
        <path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="twitter-box">
        <path
            d="M6.667 4h18.667c1.467 0 2.667 1.2 2.667 2.667v18.667c0 1.467-1.2 2.667-2.667 2.667H6.667A2.675 2.675 0 0 1 4 25.334V6.667C4 5.2 5.2 4 6.667 4zm16.946 8.44c.64-.533 1.387-1.173 1.72-1.88-.547.28-1.2.453-1.92.547.667-.48 1.213-1.107 1.493-1.96-.693.373-1.4.693-2.28.853-2.067-2.493-7.013-.467-6.133 3.267-3.48-.213-5.6-1.787-7.36-3.72-1 1.627-.133 4.093 1.053 4.773-.613-.04-1.08-.227-1.52-.44.053 2.053 1.187 3.04 2.773 3.573a4.47 4.47 0 0 1-1.52.04c.493 1.427 1.52 2.32 3.28 2.507-1.2 1.013-3.413 1.72-5.2 1.44 1.533.973 3.28 1.747 5.707 1.64 5.88-.267 9.813-4.48 9.907-10.64z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="twitter">
        <path
            d="M29.947 8a11.423 11.423 0 0 1-3.28.92 5.738 5.738 0 0 0 2.507-3.173 11.52 11.52 0 0 1-3.627 1.4C24.494 6 23.014 5.334 21.334 5.334c-3.133 0-5.693 2.56-5.693 5.72 0 .453.053.893.147 1.307A16.261 16.261 0 0 1 4.001 6.388a5.663 5.663 0 0 0-.773 2.867c0 1.987 1 3.747 2.547 4.747-.947 0-1.827-.267-2.6-.667v.04a5.724 5.724 0 0 0 4.587 5.613 5.644 5.644 0 0 1-2.574.093c.72 2.253 2.813 3.933 5.333 3.973-1.947 1.547-4.413 2.453-7.107 2.453-.453 0-.907-.027-1.36-.08A16.19 16.19 0 0 0 10.827 28c10.507 0 16.28-8.72 16.28-16.28 0-.253 0-.493-.013-.747A11.42 11.42 0 0 0 29.947 8z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="white-balance-sunny">
        <path
            d="M4.733 24.72l1.88 1.88 2.4-2.387L7.12 22.32zm9.934 5.213h2.667V26h-2.667zM16 7.333c-4.413 0-8 3.587-8 8s3.587 8 8 8 8-3.587 8-8c0-4.427-3.587-8-8-8zm10.667 9.334h4V14h-4zm-3.68 7.546l2.4 2.387 1.88-1.88-2.387-2.4zm4.28-18.266l-1.88-1.88-2.4 2.387 1.893 1.893zM17.333.733h-2.667v3.933h2.667zM5.333 14h-4v2.667h4zm3.68-7.547l-2.4-2.387-1.88 1.88 2.387 2.4 1.893-1.893z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="window-close">
        <path
            d="M17.947 16l7.387 7.387v1.947h-1.947L16 17.947l-7.387 7.387H6.666v-1.947L14.053 16 6.666 8.613V6.666h1.947L16 14.053l7.387-7.387h1.947v1.947L17.947 16z">
        </path>
    </symbol>
</svg>
    <div class="site">
        <header class="site-header container">
    <div class="header-left">
        <a class="logo" href="https://blog.karnwong.me">
                <span class="logo-text">Karn Wong&#x27;s Blog</span>
        </a>

        <a class="social-link" href="https://webring.wonderful.software#blog.karnwong.me" title="webring">
            <img alt="webring" width="32" height="32" src="https://webring.wonderful.software/webring.svg" style="padding-left: 10px;"/>
        </a>
        
    </div>
        <nav class="main-nav hidden-xs hidden-sm hidden-md">
                <a class="menu-item menu-item-homepage"
        href="https://www.karnwong.me/">Homepage</a>
    <a class="menu-item menu-item-posts"
        href="https://blog.karnwong.me/">Posts</a>
    <a class="menu-item menu-item-tags"
        href="https://blog.karnwong.me/tag/data-engineering/">Tags</a>
    <a class="menu-item menu-item-resume"
        href="https://www.karnwong.me/resume">Resume</a>

            <button class="button-icon menu-item-button js-modal" data-modal="search" aria-label="Search">
                <svg class="icon">
                    <use xlink:href="#magnify"></use>
                </svg>
            </button>
        </nav>

        <button class="button-icon hidden-lg hidden-xl js-modal" data-modal="search" aria-label="Search">
            <svg class="icon">
                <use xlink:href="#magnify"></use>
            </svg>
        </button>
        <div class="burger hidden-lg hidden-xl">
            <div class="burger-bar"></div>
            <div class="burger-bar"></div>
        </div>

        <div class="mobile-menu hidden-lg hidden-xl">
            <div class="container">
                <nav class="mobile-nav">
                        <a class="menu-item menu-item-homepage"
        href="https://www.karnwong.me/">Homepage</a>
    <a class="menu-item menu-item-posts"
        href="https://blog.karnwong.me/">Posts</a>
    <a class="menu-item menu-item-tags"
        href="https://blog.karnwong.me/tag/data-engineering/">Tags</a>
    <a class="menu-item menu-item-resume"
        href="https://www.karnwong.me/resume">Resume</a>

                        <button class="button-text menu-item members-login" data-portal="signin">Login</button>
                        <button class="button-text menu-item menu-item-cta members-subscribe" data-portal="signup">Subscribe</button>
                </nav>
            </div>
        </div>
    <div class="header-right hidden-xs hidden-sm hidden-md">
            <button class="button-text menu-item members-login" data-portal="signin">Login</button>
            <button class="button-text menu-item menu-item-cta members-subscribe" data-portal="signup">Subscribe</button>
    </div>
</header>

        <header class="sticky">
            <div class="sticky-title">Impute pipelines</div>
            <button class="button-icon sticky-toc-button" aria-label="Table of Contents">
                <svg class="icon">
                    <use xlink:href="#table-of-contents"></use>
                </svg>
                <div class="sticky-toc"></div>
            </button>
            <div class="sticky-track">
                <div class="sticky-progress"></div>
            </div>
        </header>
        <div class="site-content">
            
<div class="content-area">
    <main class="site-main">
            <article class="single post tag-data-science no-image">
    <header class="single-header kg-canvas">
            <div class="single-meta">
                <span class="single-meta-item single-meta-date">
                    <time datetime="2020-05-23">
                        May 23, 2020
                    </time>
                </span>
                <span class="single-meta-item single-meta-length">
                    7 min read
                </span>
                    <span class="single-meta-item single-meta-tag">
                        <a class="post-tag post-tag-data-science" href="/tag/data-science/">
                            data science
                        </a>
                    </span>
            </div>
        <h1 class="single-title">Impute pipelines</h1>
    </header>
    <div class="single-content kg-canvas u-text-format">
        <p>Imagine having a dataset that you need to use for training a prediction model, but some of the features are missing. The good news is you don't need to throw some data away, just have to impute them. Below are steps you can take in order to create an imputation pipeline. Github link <a href="https://github.com/kahnwong/impute-pipelines">here!</a></p><pre><code class="language-python">from random import randint

import pandas as pd
import numpy as np

from sklearn.preprocessing import OneHotEncoder
from sklearn.impute import SimpleImputer
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
from sklearn.compose import ColumnTransformer
from sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor, ExtraTreesRegressor
from sklearn.tree import DecisionTreeRegressor
from sklearn.metrics import mean_squared_error, median_absolute_error

from hyperopt import fmin, tpe, hp, Trials, STATUS_OK
import mlflow

import matplotlib.pyplot as plt
import seaborn as sns
sns.set()</code></pre><h1 id="generate-data">Generate data</h1><p><br>Since this is an example and I don't want to get sued by using my company's data, synthetic data it is :)<br>This simulates a dataset from different pseudo-regions, with different characteristics. Real data will be much more varied, but I make it more obvious so it's easy to see the differences.</p><pre><code class="language-python">def generate_array_with_random_nan(lower_bound, upper_bound, size):
    a = np.random.randint(lower_bound, upper_bound+1, size=size).astype(float)
    mask = np.random.choice([1, 0], a.shape, p=[.1, .9]).astype(bool)
    a[mask] = np.nan
    
    return a

size = 6000

df_cbd = pd.DataFrame()
df_cbd['bed'] = generate_array_with_random_nan(1, 2, size)
df_cbd['bath'] = generate_array_with_random_nan(1, 2, size)
df_cbd['area_usable'] = np.random.randint(20, 40, size=size)
df_cbd['region'] = 'cbd'

df_suburb = pd.DataFrame()
df_suburb['bed'] = generate_array_with_random_nan(1, 4, size)
df_suburb['bath'] = generate_array_with_random_nan(1, 4, size)
df_suburb['area_usable'] = np.random.randint(30, 200, size=size)
df_suburb['region'] = 'suburb'

df = pd.concat([df_cbd, df_suburb])
df</code></pre><!--kg-card-begin: markdown--><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bed</th>
<th style="text-align:right">bath</th>
<th style="text-align:right">area_usable</th>
<th style="text-align:left">region</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">33</td>
<td style="text-align:left">cbd</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">23</td>
<td style="text-align:left">cbd</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">33</td>
<td style="text-align:left">cbd</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">26</td>
<td style="text-align:left">cbd</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">28</td>
<td style="text-align:left">cbd</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">36</td>
<td style="text-align:left">cbd</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">38</td>
<td style="text-align:left">cbd</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">23</td>
<td style="text-align:left">cbd</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">36</td>
<td style="text-align:left">cbd</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">nan</td>
<td style="text-align:right">2</td>
<td style="text-align:right">29</td>
<td style="text-align:left">cbd</td>
</tr>
</tbody>
</table>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h1 id="reportmissingvalues">Report missing values</h1>
<p>I also randomly remove some values to mimic real-world data (read: they are never ready to use), here we will visualize the missing rate of each column.</p>
<pre><code class="language-python">def report_missing(df):
    cnts = []
    cnt_total = len(df)
    for col in df.columns:
        cnt_missing = sum(pd.isnull(df[col]) | pd.isna(df[col]))
        print(&quot;col: {}, missing: {}%&quot;.format(col, 100.0 * cnt_missing / cnt_total))

        cnts.append({
            'column': col,
            'missing': 100.0 * cnt_missing / cnt_total
        })

    cnts_df = pd.DataFrame(cnts)
    sns.barplot(x=cnts_df.missing, 
                y=cnts_df.column, 
    #             palette=['r','b'],
    #             data=cnts_df
               )
    
    return sns

report_missing(df)
</code></pre>
<pre><code>col: bed, missing: 10.266666666666667%
col: bath, missing: 9.616666666666667%
col: area_usable, missing: 0.0%
col: region, missing: 0.0%</code></pre>
<!--kg-card-end: markdown--><figure class="kg-card kg-image-card"><img src="https://blog.karnwong.me/content/images/2020/08/pipelines_5_2.png" class="kg-image" alt loading="lazy" width="433" height="265"></figure><!--kg-card-begin: markdown--><h1 id="dataexploration">Data exploration</h1>
<p>Knowing the missing rate isn't everything, thus it is also a good idea to explore data in other areas too.</p>
<pre><code class="language-python"># missing bed per region
df[df.bed.isna()][&quot;region&quot;].value_counts(dropna=False)
</code></pre>
<pre><code>cbd       634
suburb    598
Name: region, dtype: int64
</code></pre>
<pre><code class="language-python"># missing bath per region
df[df.bath.isna()][&quot;region&quot;].value_counts(dropna=False)
</code></pre>
<pre><code>suburb    588
cbd       566
Name: region, dtype: int64
</code></pre>
<pre><code class="language-python"># explore region
df.region.value_counts()
</code></pre>
<pre><code>suburb    6000
cbd       6000
Name: region, dtype: int64
</code></pre>
<pre><code class="language-python"># explore bed
df.bed.value_counts()
</code></pre>
<pre><code>2.0    4050
1.0    4009
4.0    1393
3.0    1316
Name: bed, dtype: int64
</code></pre>
<pre><code class="language-python"># explore bath
df.bath.value_counts()
</code></pre>
<pre><code>1.0    4142
2.0    4022
3.0    1393
4.0    1289
Name: bath, dtype: int64
</code></pre>
<h1 id="removeoutlierswouldntwantyourmodeltohaveasubparperformancefromskeweddatap">Remove outliers (wouldn't want your model to have a sub-par performance from skewed data :-P)</h1>
<pre><code class="language-python"># remove outliers here
</code></pre>
<h1 id="createsyntheticcolumns">Create synthetic columns</h1>
<p>In this step, we create percentile, mean and rank columns to add more data points, so the model can perform better :D</p>
<p>First, we find aggregate percentiles for each groupby set, then add mean and rank columns.</p>
<pre><code class="language-python">synth_columns = {
    'bed': {
        &quot;region_bath&quot;: ['region', 'bath']
    },
    'bath': {
        &quot;region_bed&quot;: ['region', 'bed']
    }
}

for column, groupby_levels in synth_columns.items():
    for groupby_level_name, groupby_columns in groupby_levels.items():
        # percentile aggregates
        for pctl in [20,50,80,90]:
            col_name = 'p{}|{}|{}'.format(pctl, groupby_level_name, column)
            print(&quot;calculating -- {}&quot;.format(col_name))
            df[col_name] = df[groupby_columns+[column]].fillna(0).groupby(groupby_columns)[column].transform(lambda x: x.quantile(pctl/100.0))

        # mean impute
        mean_impute = 'mean|{}|{}'.format(groupby_level_name,column)
        print(&quot;calculating -- {}&quot;.format(mean_impute))
        df[mean_impute] = df.groupby(groupby_columns)[column].transform('mean')
        
        # bed/bath rank
        rank_impute = column_name = 'rank|{}|{}'.format(groupby_level_name,column)
        print(&quot;calculating -- {}&quot;.format(rank_impute))
        df[rank_impute] = df.groupby(groupby_columns)[column].rank(method='dense', na_option='bottom')

</code></pre>
<pre><code>calculating -- p20|region_bath|bed
calculating -- p50|region_bath|bed
calculating -- p80|region_bath|bed
calculating -- p90|region_bath|bed
calculating -- mean|region_bath|bed
calculating -- rank|region_bath|bed
calculating -- p20|region_bed|bath
calculating -- p50|region_bed|bath
calculating -- p80|region_bed|bath
calculating -- p90|region_bed|bath
calculating -- mean|region_bed|bath
calculating -- rank|region_bed|bath
</code></pre>
<h1 id="coalescevalues">Coalesce values</h1>
<p>In this step we fill in values obtained from the previous step -- impute time!!</p>
<pre><code class="language-python">def coalesce(df, columns):
    '''
    Implement coalesce of function in colunms.
    
    Inputs:
    df: reference dataframe
    columns: columns to perform coalesce
    
    Returns:
    df_tmp: pd.Series that is coalesced
    
    Example:
    df_tmp = pd.DataFrame({'a': [1,2,None,None,None,None], 
                            'b': [None,6,None,8,9,None], 
                            'c': [None,10,None,12,None,13]})
    df_tmp['new'] = coalesce(df_tmp, ['a','b','c'])
    print(df_tmp)
    '''
    df_tmp = df[columns[0]]
    for c in columns[1:]:
        df_tmp = df_tmp.fillna(df[c])
    
    return df_tmp


coalesce_columns = [
    'bed',
    'p50|region_bath|bed',
    # p50|GROUPBY_LESSER_WEIGHT|bed, ...
]

df[&quot;bed_imputed&quot;] = coalesce(df, coalesce_columns)

coalesce_columns = [
    'bath',
    'p50|region_bed|bath',
     # p50|GROUPBY_LESSER_WEIGHT|bath, ...
]

df[&quot;bath_imputed&quot;] = coalesce(df, coalesce_columns)
</code></pre>
<h1 id="reportmissingvaluesagain">Report missing values (again)</h1>
<p>After we impute the values, let's see how much we are doing better!</p>
<pre><code class="language-python">report_missing(df)
</code></pre>
<pre><code>col: bed, missing: 10.266666666666667%
col: bath, missing: 9.616666666666667%
col: area_usable, missing: 0.0%
col: region, missing: 0.0%
col: p20|region_bath|bed, missing: 0.0%
col: p50|region_bath|bed, missing: 0.0%
col: p80|region_bath|bed, missing: 0.0%
col: p90|region_bath|bed, missing: 0.0%
col: mean|region_bath|bed, missing: 9.616666666666667%
col: rank|region_bath|bed, missing: 0.0%
col: p20|region_bed|bath, missing: 0.0%
col: p50|region_bed|bath, missing: 0.0%
col: p80|region_bed|bath, missing: 0.0%
col: p90|region_bed|bath, missing: 0.0%
col: mean|region_bed|bath, missing: 10.266666666666667%
col: rank|region_bed|bath, missing: 0.0%
col: bed_imputed, missing: 0.0%
col: bath_imputed, missing: 0.0%
</code></pre>
<!--kg-card-end: markdown--><figure class="kg-card kg-image-card"><img src="https://blog.karnwong.me/content/images/2020/08/pipelines_19_2.png" class="kg-image" alt loading="lazy" width="483" height="265"></figure><!--kg-card-begin: markdown--><p><img src="https://blog.karnwong.me/images/impute-pipelines/pipelines_19_2.png" alt="png" loading="lazy"></p>
<p>Notice that the imputed columns there are no missing values. Yay!</p>
<h1 id="assignpartition">Assign partition</h1>
<p>In this step, we partition the data into three sets: train, dev and test. Normally we only split into train and test set, but the additional &quot;dev&quot; set is there so we can make sure it's not too overfit or underfit.</p>
<pre><code class="language-python"># assign partition
def assign_partition(x):
    if x in [0,1,2,3,4,5]:
        return 0
    elif x in [6,7]:
        return 1
    else:
        return 2

# assign random id
df['listing_id'] = [randint(1000000, 9999999) for i in range(len(df))]

# hashing
df[&quot;hash_id&quot;] = df[&quot;listing_id&quot;].apply(lambda x: x % 10)

# assign partition
df[&quot;partition_id&quot;] = df[&quot;hash_id&quot;].apply(lambda x: assign_partition(x))
</code></pre>
<pre><code class="language-python"># define columns group
y_column = 'area_usable'

categ_columns = ['region']

numer_columns = [
    'bed_imputed',
    'bath_imputed',
    
    'p20|region_bath|bed',
    'p50|region_bath|bed',
    'p80|region_bath|bed',
    'p90|region_bath|bed',
    'mean|region_bath|bed',
    'rank|region_bath|bed',
    
    'p20|region_bed|bath',
    'p50|region_bed|bath',
    'p80|region_bed|bath',
    'p90|region_bed|bath',
    'mean|region_bed|bath',
    'rank|region_bed|bath',
]

id_columns = [
    'listing_id',
    'hash_id',
    'partition_id'
]
</code></pre>
<pre><code class="language-python"># remove missing y
df = df.dropna(subset=[y_column])

# split into train-dev-test
df_train = df[df[&quot;partition_id&quot;] == 0]
df_dev = df[df[&quot;partition_id&quot;] == 1]
df_test = df[df[&quot;partition_id&quot;] == 2]
</code></pre>
<pre><code class="language-python"># split each set into x and y
y_train = df_train[y_column].values
df_train = df_train[numer_columns+categ_columns]

y_dev = df_dev[y_column].values
df_dev = df_dev[numer_columns+categ_columns]

y_test = df_test[y_column].values
df_test = df_test[numer_columns+categ_columns]
</code></pre>
<h1 id="createsklearnpipelines">Create sklearn pipelines</h1>
<p>In this step, we chain a few pipelines together to process the dataset for the final time. In this example, we use median followed by standard scalar for numeric columns, and mode followed by encoding labels for categorical columns.</p>
<pre><code class="language-python"># define pipelines
impute_median = SimpleImputer(strategy='median')
impute_mode = SimpleImputer(strategy='most_frequent')

num_pipeline = Pipeline([
        ('impute_median', impute_median),
        ('std_scaler', StandardScaler()),
    ])

categ_pipeline = Pipeline([
        ('impute_mode', impute_mode),
        ('categ_1hot', OneHotEncoder(handle_unknown='ignore')),
    ])

full_pipeline = ColumnTransformer([
        (&quot;num&quot;, num_pipeline, numer_columns),
        (&quot;cat&quot;, categ_pipeline, categ_columns),
    ])
</code></pre>
<pre><code class="language-python"># fit and transform
X_train = full_pipeline.fit_transform(df_train)
X_dev = full_pipeline.transform(df_dev)
X_test = full_pipeline.transform(df_test)
</code></pre>
<pre><code class="language-python">X_train
</code></pre>
<pre><code>array([[ 0.04673184,  0.06391404,  0.        , ..., -0.16000115,
         1.        ,  0.        ],
       [-0.97000929, -0.97263688,  0.        , ..., -1.01065389,
         1.        ,  0.        ],
       [ 0.04673184,  0.06391404,  0.        , ..., -0.16000115,
         1.        ,  0.        ],
       ...,
       [-0.97000929,  1.10046497,  0.        , ...,  0.69065159,
         0.        ,  1.        ],
       [ 0.04673184,  1.10046497,  0.        , ...,  0.69065159,
         0.        ,  1.        ],
       [ 1.06347297,  2.13701589,  0.        , ...,  1.54130432,
         0.        ,  1.        ]])
</code></pre>
<h1 id="hyperparametertuning">Hyperparameter tuning</h1>
<p>In this step, we try to use different models and parameters to see which performs the best. We utilize mlflow for logging and hyperopt to help with tuning. In this example, we run the trials for 40 iterations, each using a different combination of model and parameters.</p>
<pre><code class="language-python"># mlflow + hyperopt combo
def objective(params):
    regressor_type = params['type']
    del params['type']
    if regressor_type == 'gradient_boosting_regression':
        estimator = GradientBoostingRegressor(**params)
    elif regressor_type == 'random_forest_regression':
        estimator = RandomForestRegressor(**params)
    elif regressor_type == 'extra_trees_regression':
        estimator = ExtraTreesRegressor(**params)
    elif regressor_type == 'decision_tree_regression':
        estimator = DecisionTreeRegressor(**params)
    else:
        return 0    
    
    estimator.fit(X_train, y_train)
    
    # mae    
    y_dev_hat = estimator.predict(X_dev)
    mae = median_absolute_error(y_dev, y_dev_hat)
    
    # logging
    with mlflow.start_run():
        mlflow.log_param(&quot;regressor&quot;, estimator.__class__.__name__)
        # mlflow.log_param(&quot;params&quot;, params)
        mlflow.log_param('n_estimators', params.get('n_estimators'))
        mlflow.log_param('max_depth', params.get('max_depth'))
        
        mlflow.log_metric(&quot;median_absolute_error&quot;, mae)  
    
    return {'loss': mae, 'status': STATUS_OK}

space = hp.choice('regressor_type', [    
    {
        'type': 'gradient_boosting_regression',
        'n_estimators': hp.choice('n_estimators1', range(100,200,50)),
        'max_depth': hp.choice('max_depth1', range(10,13,1))
    },
    {
        'type': 'random_forest_regression',
        'n_estimators': hp.choice('n_estimators2', range(100,200,50)),
        'max_depth': hp.choice('max_depth2', range(3,25,1)),
        'n_jobs': -1
        
    },
    {
        'type': 'extra_trees_regression',
        'n_estimators': hp.choice('n_estimators3', range(100,200,50)),
        'max_depth': hp.choice('max_depth3', range(3,10,2))
    },
    {
        'type': 'decision_tree_regression',
        'max_depth': hp.choice('max_depth4', range(3,10,2))
    }
])

trials = Trials()
max_evals = 40

best = fmin(
fn=objective, 
space=space,
algo=tpe.suggest,
max_evals=max_evals,
trials=trials)

print(&quot;Found minimum after {} trials:&quot;.format(max_evals))
from pprint import pprint
pprint(best)
</code></pre>
<pre><code>100%|██████████| 40/40 [00:19&lt;00:00,  2.11trial/s, best loss: 8.569474762575908]
Found minimum after 40 trials:
{'max_depth2': 1, 'n_estimators2': 1, 'regressor_type': 1}
</code></pre>
<h1 id="evaluateperformance">Evaluate performance</h1>
<p>Run &quot;mlflow server&quot; to see the loggin dashboard. There, we can see that RandomForestRegressor has the best performance (the less MAE the better) when using max_depth=4  and n_estimators=150, to test the model's performance against another test set:</p>
<pre><code class="language-python"># use best params on TEST set
estimator = RandomForestRegressor(max_depth=4, n_estimators=150)
estimator.fit(X_train, y_train)
    
y_train_hat = estimator.predict(X_train)
train_mae = median_absolute_error(y_train, y_train_hat)

y_dev_hat = estimator.predict(X_dev)
dev_mae = median_absolute_error(y_dev, y_dev_hat)

y_test_hat = estimator.predict(X_test)
test_mae = median_absolute_error(y_test, y_test_hat)

mae =  {
    'name': estimator.__class__.__name__,
    'train_mae': train_mae,
    'dev_mae': dev_mae,
    'test_mae': test_mae
}

mae = pd.DataFrame([mae]).set_index('name')

mae
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:right">train_mae</th>
<th style="text-align:right">dev_mae</th>
<th style="text-align:right">test_mae</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">DecisionTreeRegressor</td>
<td style="text-align:right">8.930245</td>
<td style="text-align:right">8.592484</td>
<td style="text-align:right">8.729826</td>
</tr>
</tbody>
</table>
<p>You'll notice that we use &quot;median absolute error&quot; to measure performance. There are other metrics available, such as mean squared error, but in some cases it's more meaningful to use a metric that measure the performance in actual data's unit, in this case the error on dev and test set are around 8 units away from its correct value. Since normally we use square meter for area, it means the prediction will be off by about 8 square meters in most cases.</p>
<!--kg-card-end: markdown-->
    </div>
        <footer class="single-footer container medium">
            <div class="single-footer-left">
                    <div class="navigation navigation-previous">
                        <a class="navigation-link" href="/word-based-analysis-with-song-lyrics/"
                            aria-label="Previous post">
                            <svg class="icon navigation-icon">
                                <use xlink:href="#arrow-left"></use>
                            </svg>
                        </a>
                    </div>
            </div>
            <div class="single-footer-right">
                    <div class="navigation navigation-next">
                        <a class="navigation-link" href="/aethkhtikhs-bthaamorngngaaneruue-ngkluuetn/"
                            aria-label="Next post">
                            <svg class="icon navigation-icon">
                                <use xlink:href="#arrow-right"></use>
                            </svg>
                        </a>
                    </div>
            </div>
        </footer>
</article>                            </main>
</div>
        </div>
        <footer class="site-footer container">
    <div class="social">
        <a class="social-item social-item-rss"
            href="https://blog.karnwong.me/rss/"
            target="_blank" rel="noopener noreferrer" aria-label="RSS">
            <svg class="icon">
                <use xlink:href="#rss-box"></use>
            </svg>
        </a>
    </div>

    <div class="copyright">
        Powered by <a href="https://ghost.org/" target="_blank"
            rel="noopener noreferrer">Ghost</a>
    </div>

    <nav class="footer-nav">
        
        <a class="menu-item js-theme" href="#" data-system="System theme" data-dark="Dark theme" data-light="Light theme">
            <svg class="icon theme-icon theme-icon-system">
                <use xlink:href="#circle-half-full"></use>
            </svg>
            <svg class="icon theme-icon theme-icon-dark">
                <use xlink:href="#brightness-2"></use>
            </svg>
            <svg class="icon theme-icon theme-icon-light">
                <use xlink:href="#white-balance-sunny"></use>
            </svg>
            <span class="theme-text">System theme</span>
        </a>
    </nav>
</footer>        <div class="modal-overlay">
    <div class="modal modal-search">
        <div class="form-wrapper">
            <input class="modal-input search-input" type="search" placeholder="Enter keyword...">
            <button class="form-button search-button" aria-label="Search">
                <svg class="icon icon-search">
                    <use xlink:href="#magnify"></use>
                </svg>
                <svg class="icon icon-close">
                    <use xlink:href="#window-close"></use>
                </svg>
            </button>
        </div>
                <div class="popular-wrapper">
                    <h4 class="popular-title">Popular tags</h4>
                    <div class="popular-feed">
                            <a class="popular" href="/tag/languages/">languages</a>
                            <a class="popular" href="/tag/celiac/">celiac</a>
                            <a class="popular" href="/tag/data-engineering/">data engineering</a>
                            <a class="popular" href="/tag/infra/">infra</a>
                            <a class="popular" href="/tag/data-analysis/">data analysis</a>
                    </div>
                </div>
        <div class="search-result"></div>
    </div>
    <button class="button-icon modal-close" aria-label="Close">
        <svg class="icon icon-close">
            <use xlink:href="#window-close"></use>
        </svg>
    </button>
</div>        <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe.
        It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides.
          PhotoSwipe keeps only 3 of them in the DOM to save memory.
          Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>    </div>

    <script
        src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous">
    </script>
    <script src="/assets/built/main.min.js?v=eeea2d2947"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/plugins/line-numbers/prism-line-numbers.min.css" />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-okaidia.css" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-markdown.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-toml.min.js"></script>
</body>

</html>